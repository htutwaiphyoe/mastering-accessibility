var TraverseRetargeting=function(){Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");function e(){}function i(){return n.apply(this instanceof e&&t?this:t,r.concat(Array.prototype.slice.call(arguments)))}var r=Array.prototype.slice.call(arguments,1),n=this;return e.prototype=this.prototype,i.prototype=new e,i}),"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(t){return t<10?"0"+t:t}function this_value(){return this.valueOf()}function quote(t){return rx_escapable.lastIndex=0,rx_escapable.test(t)?'"'+t.replace(rx_escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var i,r,n,o,a,c=gap,s=e[t];switch(s&&"object"==typeof s&&"function"==typeof s.toJSON&&(s=s.toJSON(t)),typeof(s="function"==typeof rep?rep.call(e,t,s):s)){case"string":return quote(s);case"number":return isFinite(s)?String(s):"null";case"boolean":case"null":return String(s);case"object":if(!s)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(s)){for(o=s.length,i=0;i<o;i+=1)a[i]=str(i,s)||"null";return n=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+c+"]":"["+a.join(",")+"]",gap=c,n}if(rep&&"object"==typeof rep)for(o=rep.length,i=0;i<o;i+=1)"string"==typeof rep[i]&&((n=str(r=rep[i],s))&&a.push(quote(r)+(gap?": ":":")+n));else for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(n=str(r,s),n&&a.push(quote(r)+(gap?": ":":")+n));return n=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+c+"}":"{"+a.join(",")+"}",gap=c,n}}var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta,rep;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value),"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(t,e,i){var r;if(indent=gap="","number"==typeof i)for(r=0;r<i;r+=1)indent+=" ";else"string"==typeof i&&(indent=i);if((rep=e)&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(t,e){var i,r,n=t[e];if(n&&"object"==typeof n)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r=walk(n,i),void 0!==r?n[i]=r:delete n[i]);return reviver.call(t,e,n)}var j;if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}();var HttpClient={get:function(t,e){this._request({method:"GET",url:t},e)},post:function(t,e,i){this._request({method:"POST",url:t,data:e},i)},_request:function(t,e){var i,r=new XMLHttpRequest;r.onreadystatechange=function(){4===r.readyState&&(200<=r.status&&r.status<400?e(null,{body:r.response,status:r.status}):((i=new Error("HTTP request failed with status code "+r.status)).status=r.status,e(i)))},r.open(t.method,t.url,!0),r.withCredentials=!0,"GET"===t.method?r.send(null):"POST"===t.method&&(r.setRequestHeader("Content-Type","application/json; charset=utf-8"),r.send(JSON.stringify(t.data)))}},DOMUtils={iframeTemplate:'<iframe src="javascript:false" class="_tvrs" style="width:0;height:0;border:0;frameborder:0;" aria-hidden="true" role="presentation" title="Traverse Retargeting"></iframe>',htmlOpen:"<html><head></head><body>",htmlClose:"</body></html>",appendToDocumentBody:function(t,e){t.getElementsByTagName("body").item(0).appendChild(e)},writeDocumentBody:function(t,e){e=this.htmlOpen+e+this.htmlClose,t.open(),t.write(e),t.close()},getIframeDocument:function(t){return t.contentDocument||(t.contentWindow||t).document},elementFromHtml:function(t){var e=document.createElement("div");return e.innerHTML=t,e.firstChild}},RetargetingClient={traverseUrl:"https://api.traversedlp.com",retargetingMatchTags:['<img src="https://api.traversedlp.com/retargeting/v1/match/lookup?campaignId=d220d921-1a8c-418d-b956-8b678623a024&redirect=api.traversedlp.com/v1/7f2715a7-b8fd-48f4-9443-d095cbdcc02e/0.gif" border="0" width="1" height="1"  alt="" class="_tvrs"/>','<img src="https://api.traversedlp.com/retargeting/v1/match/lookup?campaignId=d220d921-1a8c-418d-b956-8b678623a024&redirect=api.traversedlp.com/v1/7f2715a7-b8fd-48f4-9443-d095cbdcc02e/1.gif" border="0" width="1" height="1"  alt="" class="_tvrs"/>','<img src="https://api.traversedlp.com/retargeting/v1/match/lookup?campaignId=d220d921-1a8c-418d-b956-8b678623a024&redirect=api.traversedlp.com/v1/7f2715a7-b8fd-48f4-9443-d095cbdcc02e/2.gif" border="0" width="1" height="1"  alt="" class="_tvrs"/>','<img src="https://api.traversedlp.com/retargeting/v1/match/lookup?campaignId=d220d921-1a8c-418d-b956-8b678623a024&redirect=api.traversedlp.com/v1/7f2715a7-b8fd-48f4-9443-d095cbdcc02e/3.gif" border="0" width="1" height="1"  alt="" class="_tvrs"/>','<img src="https://api.traversedlp.com/retargeting/v1/match/lookup?campaignId=d220d921-1a8c-418d-b956-8b678623a024&redirect=api.traversedlp.com/v1/7f2715a7-b8fd-48f4-9443-d095cbdcc02e/4.gif" border="0" width="1" height="1"  alt="" class="_tvrs"/>','<img src="https://api.traversedlp.com/retargeting/v1/match/lookup?campaignId=d220d921-1a8c-418d-b956-8b678623a024&redirect=api.traversedlp.com/v1/7f2715a7-b8fd-48f4-9443-d095cbdcc02e/5.gif" border="0" width="1" height="1"  alt="" class="_tvrs"/>','<img src="https://api.traversedlp.com/retargeting/v1/match/lookup?campaignId=d220d921-1a8c-418d-b956-8b678623a024&redirect=api.traversedlp.com/v1/7f2715a7-b8fd-48f4-9443-d095cbdcc02e/6.gif" border="0" width="1" height="1"  alt="" class="_tvrs"/>','<img src="https://api.traversedlp.com/retargeting/v1/match/lookup?campaignId=d220d921-1a8c-418d-b956-8b678623a024&redirect=api.traversedlp.com/v1/7f2715a7-b8fd-48f4-9443-d095cbdcc02e/7.gif" border="0" width="1" height="1"  alt="" class="_tvrs"/>','<img src="https://api.traversedlp.com/retargeting/v1/match/lookup?campaignId=d220d921-1a8c-418d-b956-8b678623a024&redirect=api.traversedlp.com/v1/7f2715a7-b8fd-48f4-9443-d095cbdcc02e/8.gif" border="0" width="1" height="1"  alt="" class="_tvrs"/>','<img src="https://partner.mediawallahscript.com/?account_id=1006&partner_id=2080&uid={{cookieId}}&tag_format=img&tag_action=sync&cb={{unixTimestamp}}" border="0" width="1" height="1"  alt="" class="_tvrs"/>'],config:void 0,cookie:void 0,cookieCallback:void 0,_initializationCompleteCallbacks:[],init:function(t){var i=this;if(void 0===t||void 0===t.advertiserId&&void 0===t.propertyId)throw new Error("Missing required configuration parameter 'advertiserId' or 'propertyId'");this.config=t,i._getCookie(function(t,e){if(t)throw t;i._setCookieData(e),(e.isNewSync||i.config.debug)&&((t=e).advertiserId=i.config.advertiserId,t.unixTimestamp=Date.now(),i._fireTags(i.retargetingMatchTags,e)),i._initializationComplete()})},event:function(t){var e,i=this;this._waitForInitializationComplete(function(){if(void 0===t||void 0===t.type)throw new Error("Missing required configuration parameter 'type'");if(!i._isInitialized())throw new Error("TraverseRetargeting not initialized");if(!i.config.propertyId)throw new Error("TraverseRetargeting misconfiguration 'propertyId' required for events");t.advertiserId=i.config.advertiserId,t.propertyId=i.config.propertyId,t.sessionId=i.config.sessionId,e=function(){t.cookieId=i.cookie.cookieId,i._postEvent(t,i._finalCallback)},i._isCookieSet()?e():i.cookieCallback=e})},include:function(t){var e,i=this;this._waitForInitializationComplete(function(){if(void 0===t||void 0===t.campaignId)throw new Error("Missing required configuration parameter 'advertiserId'");if(!i._isInitialized())throw new Error("TraverseRetargeting not initialized");if(!i.config.advertiserId)throw new Error("TraverseRetargeting misconfiguration 'advertiserId' required for inclusions");t.advertiserId=i.config.advertiserId,i.config.campaignId=i.campaignId,t.fingerprint=i.fingerprint,e=function(){t.cookieId=i.cookie.cookieId,i._postInclusion(t,i._finalCallback)},i._isCookieSet()?e():i.cookieCallback=e})},_postInclusion:function(t,e){HttpClient.post(this.traverseUrl+"/retargetinginclusion/enqueue",t,e)},_postEvent:function(t,e){HttpClient.post(this.traverseUrl+"/v1/event",t,e)},_getDeviceFingerprintConfig:function(t){return t(null,!1)},_waitForInitializationComplete:function(t){if(this._isInitializationComplete)return t();this._initializationCompleteCallbacks.push(t)},_initializationComplete:function(){this._isInitializationComplete=!0;for(var t=0;t<this._initializationCompleteCallbacks.length;t++)this._initializationCompleteCallbacks[t]()},exclude:function(t){var e,i=this;this._waitForInitializationComplete(function(){if(void 0===t||void 0===t.campaignId)throw new Error("Missing required configuration parameter 'campaignId'");if(!i._isInitialized())throw new Error("TraverseRetargeting not initialized");if(!i.config.advertiserId)throw new Error("TraverseRetargeting misconfiguration 'advertiserId' required for exclusions");t.advertiserId=i.config.advertiserId,i.config.campaignId=i.campaignId,e=function(){t.cookieId=i.cookie.cookieId,i._postExclusion(t,i._finalCallback)},i._isCookieSet()?e():i.cookieCallback=e})},_postExclusion:function(t,e){HttpClient.post(this.traverseUrl+"/retargetingexclusion/enqueue",t,e)},_finalCallback:function(t,e){if(t)throw t},_setCookieData:function(t){this.cookie=t,void 0!==this.cookieCallback&&(this.cookieCallback(),this.cookieCallback=void 0)},_isInitialized:function(){return void 0!==this.config},_isCookieSet:function(){return void 0!==this.cookie},_fireTags:function(t,e){var i,r=DOMUtils.elementFromHtml(DOMUtils.iframeTemplate);DOMUtils.appendToDocumentBody(window.document,r),r=DOMUtils.getIframeDocument(r),i="";for(var n=0;n<t.length;n++)i+=this._replaceStringVariables(t[n],e);DOMUtils.writeDocumentBody(r,i)},_getCookie:function(i){HttpClient.get(this.traverseUrl+"/retargeting/v1/cookie",function(t,e){if(t)throw t;i(null,JSON.parse(e.body))})},_replaceStringVariables:function(t,e){var i,r=new RegExp("{{[^}]+}}","g");return t.replace(r,function(t){if(i=t.substr(2,t.length-4),void 0!==e[i])return encodeURIComponent(e[i]);throw Error("Attribute `"+i+"` was requested but was not provided.")})}},init=RetargetingClient.init,include=RetargetingClient.include,exclude=RetargetingClient.exclude,event=RetargetingClient.event;return{init:init.bind(RetargetingClient),include:include.bind(RetargetingClient),exclude:exclude.bind(RetargetingClient),event:event.bind(RetargetingClient),DOMUtils:DOMUtils,HttpClient:HttpClient,RetargetingClient:RetargetingClient}}();